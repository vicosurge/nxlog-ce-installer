include tmp/common.conf
NoCache TRUE

<Extension _json>
    Module  xm_json
</Extension>

# tag::manual_include[]
<Extension _syslog>
    Module  xm_syslog
</Extension>

<Extension grok>
    Module  xm_grok
    Pattern modules/extension/grok/patterns2.txt
</Extension>

<Input in>
    Module  im_file
    File    'test2.log'
# end::manual_include[]

    ReadFromLast    FALSE

# tag::manual_include[]
    <Exec>
        parse_syslog_bsd();
        if match_grok($Message, "%{SSH_AUTHFAIL_WRONGUSER}") {}
        else if match_grok($Message, "%{SSH_AUTHFAIL_WRONGCREDS}") {}
        else if match_grok($Message, "%{SSH_AUTH_SUCCESS}") {}
        else if match_grok($Message, "%{SSH_DISCONNECT}") {}
        else
        {
            log_info('Event did not match any pattern');
        }
    </Exec>
</Input>
# end::manual_include[]

<Output out>
    Module  om_file
    File    'tmp/output'
    <Exec>
        delete($EventReceivedTime);
        to_json();
    </Exec>
</Output>

<Route r>
  Path in => out
</Route>
