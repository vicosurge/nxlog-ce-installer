include tmp/common.conf

<Extension py>
    Module          xm_python
    PythonCode        modules/extension/python/py/processlogs.py
</Extension>

<Input filein>
    Module          im_file
    File            'modules/extension/python/input/input2.txt'
    ReadFromLast    FALSE
    SavePos         FALSE
</Input>

<Input internal>
    Module im_internal
</Input>

<Output null>
    Module          om_null
    Exec            python_call("bad_process1");
    Exec            python_call("bad_process2");
    Exec            python_call("bad_process3");
</Output>

<Output out>
    Module          om_file
    File            'tmp/output'
    # Truncate "header" date, time and hostname
    Exec if ( $raw_event =~ /.+? (DEBUG|INFO|WARNING|ERROR|CRITICAL) (.*)$/ ) $raw_event = $1 + " " + $2;
    # Truncate ProcessID
    Exec if ( $raw_event =~ /^(.*?) ProcessID="\d+" (.*?)$/ ) $raw_event = $1 + " " + $2;
    # Truncate generate file path
    Exec if $raw_event =~ /^(.*?at:).+?$/ $raw_event = $1;
</Output>

<Route py>
    Path            filein => null
</Route>

<Route log>
    Path            internal => out
</Route>